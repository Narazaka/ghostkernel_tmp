(function(){var t;t=function(){function t(t,n){this.profile=t,this.plugins=n,this.ghosts=[]}return t.prototype.ghosts=null,t.prototype.boot_ghost=function(t,n,o){return this.get_kernel(t,n,o).then(function(t){return t.start()})},t.prototype.get_kernel=function(t,n,o,e,r){return Promise.all([this._get_ghost(t,e),this._get_shell(t,n,e),this._get_balloon(o,e)]).then(function(t){var n,o,e,l,i,_;return l=t[0],e=t[1],n=t[2],i=new Shiorif(l),o=r.register_named(e,n),_=new SakuraScriptPlayer(o),new GhostKernel(i,o,_)})},t._canondirpath=function(t){var n;return n=t.match(/[\\\/]/)[0],t.replace(new RegExp("\\"+n+"?$"),n)},t.prototype._get_ghost=function(n,o){return this.on_load_ghost_files(n),t._get_ghost_directory(n,o).then(function(o){return function(e){return o.on_ghost_load(n,e),t._load_ghost(e)}}(this)).then(function(t){return function(o){return t.on_ghost_loaded(n,o),o}}(this))},t._get_ghost_directory=function(n,o){var e;return e=t._canondirpath(o.ghost_master_path(n)),o.ghost_master(n)},t._load_ghost=function(t){return ShioriLoader.detect_shiori(storage.backend.fs,dirpath).then(function(t){return t.load(dirpath)})},t.prototype._get_shell=function(n,o,e){return this.on_load_shell_files(n,o),t._get_shell_directory(n,o,e).then(function(e){return function(r){return e.on_shell_load(n,o,r),t._load_shell(r)}}(this)).then(function(t){return function(e){return t.on_shell_loaded(n,o,e),e}}(this))},t._get_shell_directory=function(t,n,o){return o.shell(t,n)},t._load_shell=function(t){var n;return n=new cuttlebone.Shell(t.asArrayBuffer()),n.load()},t.prototype._get_balloon=function(n,o){return this.on_load_balloon_files(n),t._get_balloon_directory(n,o).then(function(o){return function(e){return o.on_balloon_load(n,e),t._load_balloon(e)}}(this)).then(function(t){return function(o){return t.on_balloon_loaded(n,shell),o}}(this))},t._get_balloon_directory=function(t,n){return n.balloon(t)},t._load_balloon=function(t){var n;return n=new cuttlebone.Balloon(t.asArrayBuffer()),n.load()},t}(),null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports={GhostManager:t}:this.GhostManager=t}).call(this);
//# sourceMappingURL=ghostmanager.min.js.map
